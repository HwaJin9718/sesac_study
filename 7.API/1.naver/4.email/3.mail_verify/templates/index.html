<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h2>회원 가입</h2>
    <!-- 이메일만 검증 -->
     <div>
        <label for="email">이메일:</label>
        <input type="email" id="email">
        <button id="emailBtn">인증코드 전송</button>
     </div>

     <div>
        <label for="code">인증코드:</label>
        <input type="text" id="code">
        <button id="codeBtn">인증코드 확인</button>
     </div>

     <p id="result">
        <!-- 인증 결과 출력할 곳 -->
     </p>

     <!-- 강사님 코드 -->
    <!-- <div>
        <label for="email">이메일:</label>
        <input type="email" id="email">
        <button onclick="sendCode()">인증코드 전송</button>
    </div>

    <div>
        <label for="code">인증코드:</label>
        <input type="text" id="code">
        <button onclick="verifyCode()">인증코드 확인</button>
    </div>

    <p id="result"></p> -->

     <script>
        // 미션1. email 주소 가져다 서버로 보내기 (/send-code)
        // result에 "메일 전송 성공/실패 여부 출력" -> 서버에서 받아와서 진행
        // 미션2. code를 가져다가 서버로 보내기 (/verify-code)
        // result에 "검증 코드 일치/불일치 여부 출력" -> 서버에서 받아와서 진행

        document.getElementById('emailBtn').addEventListener('click', () => {
            // console.log('emailBtn 클릭함수 진입');
            
            const email = document.getElementById('email').value
            // console.log('email 값', email);

            const formData = new FormData();
            formData.append('email', email);

            // console.log('formData 값', formData)

            fetch('/send-code', {
                method : 'POST',
                body : formData
            })
                .then(response => response.json())
                .then(result => {
                    console.log('전달된 result', result.result)
                    const resultP = document.getElementById('result')
                    resultP.innerText = result.result
                })
        })

        document.getElementById('codeBtn').addEventListener('click', () => {
            // console.log('emailBtn 클릭함수 진입');
            
            const code = document.getElementById('code').value
            // console.log('code 값', code);

            const formData = new FormData();
            formData.append('code', code);

            // console.log('formData 값', formData)

            fetch('/verify-code', {
                method : 'POST',
                body : formData
            })
                .then(response => response.json())
                .then(result => {
                    console.log('전달된 result', result.result)
                    const resultP = document.getElementById('result')
                    resultP.innerText = result.result
                })
        })

        // 미션1. email 주소 가져다가 서버로 보내기 (/send-code)
        // async function sendCode() {
        //     const email = document.getElementById('email').value;
        //     const response = await fetch('/send-code', {
        //         method: 'POST',
        //         headers: {"Content-Type":"application/json"},
        //         body: JSON.stringify({ email })
        //     })

        //     // result 에다가 "메일 전송 성공/실패 여부 출력" (서버에서 받아와서...)
        //     const data = await response.json();
        //     document.getElementById('result').innerText = data.message || data.error;
        // }

        // 미션2. code를 가져다가 서버로 보내기 (/verify-code)
        // async function verifyCode() {
        //     const code = document.getElementById('code').value;
        //     const response = await fetch('/verify-code', {
        //         method: 'POST',
        //         headers: {'Content-Type': 'application/json'},
        //         body: JSON.stringify({ code })
        //     })
        //     // result 에다가 "검증 코드 맞음/틀림 여부 출력" (서버에서 받아와서...)
        //     const data = await response.json();
        //     document.getElementById('result').innerText = data.message || data.error;
        // }
     </script>
</body>
</html>